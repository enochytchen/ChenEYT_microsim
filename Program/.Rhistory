linewidth = 1.2, alpha = 1)  +
# Semi-Markov: FPM, ASF
geom_line(data = OS_semiMarkov_fpm_ac_RFC, aes(x = time, y = prob*100, color = "l4", linetype = "l4"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 1)  +
# Semi-Markov: FPM, RSF
geom_line(data = OS_semiMarkov_fpm_rel_RFC, aes(x = time, y = prob*100, color = "l5", linetype = "l5"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
# Markov: SPM, ASF
geom_line(data = OS_Markov_williams_ac_RFC, aes(x = time, y = prob*100, color = "l6", linetype = "l6"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
# Markov: FPM, ASF
geom_line(data = OS_Markov_fpm_ac_RFC, aes(x = time, y = prob*100, color = "l7", linetype = "l7"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
# Markov: FPM, RSF
geom_line(data = OS_Markov_fpm_rel_RFC, aes(x = time, y = prob*100, color = "l8", linetype = "l8"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
labs(x = "Time (years)", y = "Survival probability (%)", fill = "") +
scale_x_continuous(breaks = seq(0, 50, by = 5), limits = c(0, 50),
labels = seq(0, 50, by = 5), minor_breaks = seq(0, 50, by = 1)) +
scale_y_continuous(breaks = seq(0, 100, by = 20), limits = c(0, 100),
labels = seq(0, 100, by = 20), minor_breaks = seq(0, 100, by = 5)) +
scale_color_manual(values = c("l1" = "darkolivegreen3", "l2" = "navy",
"l3" = "royalblue2", "l4" = "mediumorchid3",
"l5" = "firebrick2", "l6" = "darkorange1",
"l7" = "gold", "l8" = "lightblue1"),
labels = c("Observed 4-year OS", "Observed 8-year OS",
"Semi-Markov: SPM, ASF (Williams 2017)", "Semi-Markov: FPM, ASF", "Semi-Markov: FPM, RSF",
"Markov: SPM, ASF", "Markov: FPM, ASF", "Markov: FPM, RSF"),
name = "") +
scale_linetype_manual(values = c("l1" = "solid", "l2" = "solid", "l3" = "dashed", "l4" = "twodash", "l5" = "dotdash", "l6" = "longdash", "l7" = "dashed", "l8" = "twodash"),
labels = c("Observed 4-year OS", "Observed 8-year OS", "Semi-Markov: SPM, ASF (Williams 2017)",
"Semi-Markov: FPM, ASF", "Semi-Markov: FPM, RSF",
"Markov: SPM, ASF", "Markov: FPM, ASF", "Markov: FPM, RSF"),
name = "") +
guides(x = "axis_minor", y = "axis_minor",
color = guide_legend(nrow = 4, override.aes = list(linewidth = 1.2)), linetype = guide_legend(nrow = 4), keyheight = unit(2, "lines")) +
theme(legend.position = "bottom",
legend.title = element_text(size = 24),
legend.key = element_rect(colour = NA, fill = NA),
legend.key.width = unit(1.5, "cm"),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.line = element_line(color = "black"),
plot.title = element_text(hjust = 0.5, size = 24),
axis.text = element_text(size = 12),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
legend.text = element_text(size = 12)) +
ggtitle("RFC")
plot_RFC
semiMarkov_williams_ac_FC
##############################################################
##============================================================
## Plot the observed and the extrapolated results
##============================================================
##############################################################
# Plot
plot_RFC <- ggplot() +
# Observed 4 years (Hallek2010)
geom_step(data = mfit1_data_RFC, aes(x = time, y = surv*100, color = "l1", linetype = "l1"), inherit.aes = FALSE,
direction = "hv", linewidth = 1.2, alpha = 0.8) +
# Observed 8 years  (Fischer2016)
geom_step(data = mfit2_data_RFC, aes(x = time, y = surv*100, color = "l2", linetype = "l2"), inherit.aes = FALSE,
direction = "hv", linewidth = 1.2, alpha = 0.8)  +
# Semi-Markov: SPM, ASF (Williams2017)
geom_line(data = OS_semiMarkov_williams_ac_RFC, aes(x = time, y = prob*100, color = "l3", linetype = "l3"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 1)  +
# Semi-Markov: FPM, ASF
geom_line(data = OS_semiMarkov_fpm_ac_RFC, aes(x = time, y = prob*100, color = "l4", linetype = "l4"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 1)  +
# Semi-Markov: FPM, RSF
geom_line(data = OS_semiMarkov_fpm_rel_RFC, aes(x = time, y = prob*100, color = "l5", linetype = "l5"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
# Markov: SPM, ASF
geom_line(data = OS_Markov_williams_ac_RFC, aes(x = time, y = prob*100, color = "l6", linetype = "l6"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
# Markov: FPM, ASF
geom_line(data = OS_Markov_fpm_ac_RFC, aes(x = time, y = prob*100, color = "l7", linetype = "l7"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
# Markov: FPM, RSF
geom_line(data = OS_Markov_fpm_rel_RFC, aes(x = time, y = prob*100, color = "l8", linetype = "l8"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
labs(x = "Time (years)", y = "Survival probability (%)", fill = "") +
scale_x_continuous(breaks = seq(0, 50, by = 5), limits = c(0, 50),
labels = seq(0, 50, by = 5), minor_breaks = seq(0, 50, by = 1)) +
scale_y_continuous(breaks = seq(0, 100, by = 20), limits = c(0, 100),
labels = seq(0, 100, by = 20), minor_breaks = seq(0, 100, by = 5)) +
scale_color_manual(values = c("l1" = "darkolivegreen3", "l2" = "navy",
"l3" = "royalblue2", "l4" = "mediumorchid3",
"l5" = "firebrick2", "l6" = "darkorange1",
"l7" = "gold", "l8" = "lightblue1"),
labels = c("Observed 4-year OS", "Observed 8-year OS",
"Semi-Markov: SPM, ASF (Williams 2017)", "Semi-Markov: FPM, ASF", "Semi-Markov: FPM, RSF",
"Markov: SPM, ASF", "Markov: FPM, ASF", "Markov: FPM, RSF"),
name = "") +
scale_linetype_manual(values = c("l1" = "solid", "l2" = "solid", "l3" = "dashed", "l4" = "twodash", "l5" = "dotdash", "l6" = "longdash", "l7" = "dashed", "l8" = "twodash"),
labels = c("Observed 4-year OS", "Observed 8-year OS", "Semi-Markov: SPM, ASF (Williams 2017)",
"Semi-Markov: FPM, ASF", "Semi-Markov: FPM, RSF",
"Markov: SPM, ASF", "Markov: FPM, ASF", "Markov: FPM, RSF"),
name = "") +
guides(x = "axis_minor", y = "axis_minor",
color = guide_legend(nrow = 4, override.aes = list(linewidth = 1.2)), linetype = guide_legend(nrow = 4), keyheight = unit(2, "lines")) +
theme(legend.position = "bottom",
legend.title = element_text(size = 24),
legend.key = element_rect(colour = NA, fill = NA),
legend.key.width = unit(1.5, "cm"),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.line = element_line(color = "black"),
plot.title = element_text(hjust = 0.5, size = 24),
axis.text = element_text(size = 12),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
legend.text = element_text(size = 12)) +
ggtitle("RFC")
plot_RFC
##############################################################
##============================================================
## Plot the observed and the extrapolated results
##============================================================
##############################################################
# Plot
plot_RFC <- ggplot() +
# Observed 4 years (Hallek2010)
geom_step(data = mfit1_data_RFC, aes(x = time, y = surv*100, color = "l1", linetype = "l1"), inherit.aes = FALSE,
direction = "hv", linewidth = 1.2, alpha = 0.8) +
# Observed 8 years  (Fischer2016)
geom_step(data = mfit2_data_RFC, aes(x = time, y = surv*100, color = "l2", linetype = "l2"), inherit.aes = FALSE,
direction = "hv", linewidth = 1.2, alpha = 0.8)  +
# Semi-Markov: SPM, ASF (Williams2017)
geom_line(data = OS_semiMarkov_williams_ac_RFC, aes(x = time, y = prob*100, color = "l3", linetype = "l3"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 1)  +
# Semi-Markov: FPM, ASF
geom_line(data = OS_semiMarkov_fpm_ac_RFC, aes(x = time, y = prob*100, color = "l4", linetype = "l4"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 1)  +
# Semi-Markov: FPM, RSF
geom_line(data = OS_semiMarkov_fpm_rel_RFC, aes(x = time, y = prob*100, color = "l5", linetype = "l5"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
# Markov: SPM, ASF
geom_line(data = OS_Markov_williams_ac_RFC, aes(x = time, y = prob*100, color = "l6", linetype = "l6"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
# Markov: FPM, ASF
geom_line(data = OS_Markov_fpm_ac_RFC, aes(x = time, y = prob*100, color = "l7", linetype = "l7"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
# Markov: FPM, RSF
geom_line(data = OS_Markov_fpm_rel_RFC, aes(x = time, y = prob*100, color = "l8", linetype = "l8"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
labs(x = "Time (years)", y = "Survival probability (%)", fill = "") +
scale_x_continuous(breaks = seq(0, 50, by = 5), limits = c(0, 50),
labels = seq(0, 50, by = 5), minor_breaks = seq(0, 50, by = 1)) +
scale_y_continuous(breaks = seq(0, 100, by = 20), limits = c(0, 100),
labels = seq(0, 100, by = 20), minor_breaks = seq(0, 100, by = 5)) +
scale_color_manual(values = c("l1" = "darkolivegreen3", "l2" = "navy",
"l3" = "royalblue2", "l4" = "mediumorchid3",
"l5" = "firebrick2", "l6" = "darkorange1",
"l7" = "gold", "l8" = "cyan"),
labels = c("Observed 4-year OS", "Observed 8-year OS",
"Semi-Markov: SPM, ASF (Williams 2017)", "Semi-Markov: FPM, ASF", "Semi-Markov: FPM, RSF",
"Markov: SPM, ASF", "Markov: FPM, ASF", "Markov: FPM, RSF"),
name = "") +
scale_linetype_manual(values = c("l1" = "solid", "l2" = "solid", "l3" = "dashed", "l4" = "twodash", "l5" = "dotdash", "l6" = "longdash", "l7" = "dashed", "l8" = "twodash"),
labels = c("Observed 4-year OS", "Observed 8-year OS", "Semi-Markov: SPM, ASF (Williams 2017)",
"Semi-Markov: FPM, ASF", "Semi-Markov: FPM, RSF",
"Markov: SPM, ASF", "Markov: FPM, ASF", "Markov: FPM, RSF"),
name = "") +
guides(x = "axis_minor", y = "axis_minor",
color = guide_legend(nrow = 4, override.aes = list(linewidth = 1.2)), linetype = guide_legend(nrow = 4), keyheight = unit(2, "lines")) +
theme(legend.position = "bottom",
legend.title = element_text(size = 24),
legend.key = element_rect(colour = NA, fill = NA),
legend.key.width = unit(1.5, "cm"),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.line = element_line(color = "black"),
plot.title = element_text(hjust = 0.5, size = 24),
axis.text = element_text(size = 12),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
legend.text = element_text(size = 12)) +
ggtitle("RFC")
plot_RFC
plot_FC <- ggplot() +
# Observed 4 years (Hallek2010)
geom_step(data = mfit1_data_FC, aes(x = time, y = surv*100, color = "l1", linetype = "l1"), inherit.aes = FALSE,
direction = "hv", linewidth = 1.2, alpha = 0.8) +
# Observed 8 years  (Fischer2016)
geom_step(data = mfit2_data_FC, aes(x = time, y = surv*100, color = "l2", linetype = "l2"), inherit.aes = FALSE,
direction = "hv", linewidth = 1.2, alpha = 0.8)  +
# Semi-Markov: SPM, ASF (Williams2017)
geom_line(data = OS_semiMarkov_williams_ac_FC, aes(x = time, y = prob*100, color = "l3", linetype = "l3"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 1)  +
# Semi-Markov: FPM, ASF
geom_line(data = OS_semiMarkov_fpm_ac_FC, aes(x = time, y = prob*100, color = "l4", linetype = "l4"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 1)  +
# Semi-Markov: FPM, RSF
geom_line(data = OS_semiMarkov_fpm_rel_FC, aes(x = time, y = prob*100, color = "l5", linetype = "l5"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
# Markov: SPM, ASF
geom_line(data = OS_Markov_williams_ac_FC, aes(x = time, y = prob*100, color = "l6", linetype = "l6"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
# Markov: FPM, ASF
geom_line(data = OS_Markov_fpm_ac_FC, aes(x = time, y = prob*100, color = "l7", linetype = "l7"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
# Markov: FPM, RSF
geom_line(data = OS_Markov_fpm_rel_FC, aes(x = time, y = prob*100, color = "l8", linetype = "l8"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
labs(x = "Time (years)", y = "Survival probability (%)", fill = "") +
scale_x_continuous(breaks = seq(0, 50, by = 5), limits = c(0, 50),
labels = seq(0, 50, by = 5), minor_breaks = seq(0, 50, by = 1)) +
scale_y_continuous(breaks = seq(0, 100, by = 20), limits = c(0, 100),
labels = seq(0, 100, by = 20), minor_breaks = seq(0, 100, by = 5)) +
scale_color_manual(values = c("l1" = "darkolivegreen3", "l2" = "navy",
"l3" = "royalblue2", "l4" = "mediumorchid3",
"l5" = "firebrick2", "l6" = "darkorange1",
"l7" = "gold", "l8" = "cyan"),
labels = c("Observed 4-year OS", "Observed 8-year OS", "Semi-Markov: SPM, ASF (Williams 2017)",
"Semi-Markov: FPM, ASF", "Microsimulation: SPM, ASF", "Microsimulation: FPM, ASF",
"Microsimulation: FPM, RSF"),
name = "") +
scale_linetype_manual(values = c("l1" = "solid", "l2" = "solid", "l3" = "dashed", "l4" = "twodash", "l5" = "dotdash", "l6" = "longdash", "l7" = "dashed", "l8" = "twodash"),
labels = c("Observed 4-year OS", "Observed 8-year OS", "Semi-Markov: SPM, ASF (Williams 2017)",
"Semi-Markov: FPM, ASF", "Semi-Markov: FPM, RSF",
"Markov: SPM, ASF", "Markov: FPM, ASF", "Markov: FPM, RSF"),
name = "") +
guides(x = "axis_minor", y = "axis_minor",
color = guide_legend(nrow = 4, override.aes = list(linewidth = 1.2)), linetype = guide_legend(nrow = 4), keyheight = unit(2, "lines")) +
theme(legend.position = "bottom",
legend.title = element_text(size = 24),
legend.key = element_rect(colour = NA, fill = NA),
legend.key.width = unit(1.5, "cm"),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.line = element_line(color = "black"),
plot.title = element_text(hjust = 0.5, size = 24),
axis.text = element_text(size = 12),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
legend.text = element_text(size = 12)) +
ggtitle("FC")
plot_FC
##############################################################
##============================================================
## Combine RFC and FC plots into one figure and export
##============================================================
##############################################################
## Plot two figures together
plot <- ggarrange(plot_RFC, plot_FC, ncol = 2,
common.legend = TRUE, legend="bottom",
align = "h")
plot
## Assign the output route
getwd()
ggsave("../Output/04c_figure_survextrap.png", plot, width = 10, height = 7, units = "in", dpi = 300)
plot_FC <- ggplot() +
# Semi-Markov: SPM, ASF (Williams2017)
geom_line(data = OS_semiMarkov_williams_ac_FC, aes(x = time, y = prob*100, color = "l3", linetype = "l3"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 1)  +
# Semi-Markov: FPM, ASF
geom_line(data = OS_semiMarkov_fpm_ac_FC, aes(x = time, y = prob*100, color = "l4", linetype = "l4"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 1)  +
# Semi-Markov: FPM, RSF
geom_line(data = OS_semiMarkov_fpm_rel_FC, aes(x = time, y = prob*100, color = "l5", linetype = "l5"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
# Markov: SPM, ASF
geom_line(data = OS_Markov_williams_ac_FC, aes(x = time, y = prob*100, color = "l6", linetype = "l6"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
# Markov: FPM, ASF
geom_line(data = OS_Markov_fpm_ac_FC, aes(x = time, y = prob*100, color = "l7", linetype = "l7"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
# Markov: FPM, RSF
geom_line(data = OS_Markov_fpm_rel_FC, aes(x = time, y = prob*100, color = "l8", linetype = "l8"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
# Observed 4 years (Hallek2010)
geom_step(data = mfit1_data_FC, aes(x = time, y = surv*100, color = "l1", linetype = "l1"), inherit.aes = FALSE,
direction = "hv", linewidth = 1.2, alpha = 0.8) +
labs(x = "Time (years)", y = "Survival probability (%)", fill = "") +
scale_x_continuous(breaks = seq(0, 50, by = 5), limits = c(0, 50),
labels = seq(0, 50, by = 5), minor_breaks = seq(0, 50, by = 1)) +
scale_y_continuous(breaks = seq(0, 100, by = 20), limits = c(0, 100),
labels = seq(0, 100, by = 20), minor_breaks = seq(0, 100, by = 5)) +
scale_color_manual(values = c("l1" = "darkolivegreen3", "l2" = "navy",
"l3" = "royalblue2", "l4" = "mediumorchid3",
"l5" = "firebrick2", "l6" = "darkorange1",
"l7" = "gold", "l8" = "cyan"),
labels = c("Observed 4-year OS", "Observed 8-year OS", "Semi-Markov: SPM, ASF (Williams 2017)",
"Semi-Markov: FPM, ASF", "Microsimulation: SPM, ASF", "Microsimulation: FPM, ASF",
"Microsimulation: FPM, RSF"),
name = "") +
scale_linetype_manual(values = c("l1" = "solid", "l2" = "solid", "l3" = "dashed", "l4" = "twodash", "l5" = "dotdash", "l6" = "longdash", "l7" = "dashed", "l8" = "twodash"),
labels = c("Observed 4-year OS", "Observed 8-year OS", "Semi-Markov: SPM, ASF (Williams 2017)",
"Semi-Markov: FPM, ASF", "Semi-Markov: FPM, RSF",
"Markov: SPM, ASF", "Markov: FPM, ASF", "Markov: FPM, RSF"),
name = "") +
guides(x = "axis_minor", y = "axis_minor",
color = guide_legend(nrow = 4, override.aes = list(linewidth = 1.2)), linetype = guide_legend(nrow = 4), keyheight = unit(2, "lines")) +
theme(legend.position = "bottom",
legend.title = element_text(size = 24),
legend.key = element_rect(colour = NA, fill = NA),
legend.key.width = unit(1.5, "cm"),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.line = element_line(color = "black"),
plot.title = element_text(hjust = 0.5, size = 24),
axis.text = element_text(size = 12),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
legend.text = element_text(size = 12)) +
ggtitle("FC")
##############################################################
##============================================================
## Plot the observed and the extrapolated results
##============================================================
##############################################################
# Plot
plot_RFC <- ggplot() +
# Semi-Markov: SPM, ASF (Williams2017)
geom_line(data = OS_semiMarkov_williams_ac_RFC, aes(x = time, y = prob*100, color = "l3", linetype = "l3"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 1)  +
# Semi-Markov: FPM, ASF
geom_line(data = OS_semiMarkov_fpm_ac_RFC, aes(x = time, y = prob*100, color = "l4", linetype = "l4"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 1)  +
# Semi-Markov: FPM, RSF
geom_line(data = OS_semiMarkov_fpm_rel_RFC, aes(x = time, y = prob*100, color = "l5", linetype = "l5"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
# Markov: SPM, ASF
geom_line(data = OS_Markov_williams_ac_RFC, aes(x = time, y = prob*100, color = "l6", linetype = "l6"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
# Markov: FPM, ASF
geom_line(data = OS_Markov_fpm_ac_RFC, aes(x = time, y = prob*100, color = "l7", linetype = "l7"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
# Markov: FPM, RSF
geom_line(data = OS_Markov_fpm_rel_RFC, aes(x = time, y = prob*100, color = "l8", linetype = "l8"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
# Observed 8 years  (Fischer2016)
geom_step(data = mfit2_data_RFC, aes(x = time, y = surv*100, color = "l2", linetype = "l2"), inherit.aes = FALSE,
direction = "hv", linewidth = 1.2, alpha = 0.8)  +
# Observed 4 years (Hallek2010)
geom_step(data = mfit1_data_RFC, aes(x = time, y = surv*100, color = "l1", linetype = "l1"), inherit.aes = FALSE,
direction = "hv", linewidth = 1.2, alpha = 0.8) +
labs(x = "Time (years)", y = "Survival probability (%)", fill = "") +
scale_x_continuous(breaks = seq(0, 50, by = 5), limits = c(0, 50),
labels = seq(0, 50, by = 5), minor_breaks = seq(0, 50, by = 1)) +
scale_y_continuous(breaks = seq(0, 100, by = 20), limits = c(0, 100),
labels = seq(0, 100, by = 20), minor_breaks = seq(0, 100, by = 5)) +
scale_color_manual(values = c("l1" = "black", "l2" = "darkolivegreen3",
"l3" = "royalblue2", "l4" = "mediumorchid3",
"l5" = "firebrick2", "l6" = "darkorange1",
"l7" = "gold", "l8" = "cyan"),
labels = c("Observed 4-year OS", "Observed 8-year OS",
"Semi-Markov: SPM, ASF (Williams 2017)", "Semi-Markov: FPM, ASF", "Semi-Markov: FPM, RSF",
"Markov: SPM, ASF", "Markov: FPM, ASF", "Markov: FPM, RSF"),
name = "") +
scale_linetype_manual(values = c("l1" = "solid", "l2" = "solid", "l3" = "dashed", "l4" = "twodash", "l5" = "dotdash", "l6" = "longdash", "l7" = "dashed", "l8" = "twodash"),
labels = c("Observed 4-year OS", "Observed 8-year OS", "Semi-Markov: SPM, ASF (Williams 2017)",
"Semi-Markov: FPM, ASF", "Semi-Markov: FPM, RSF",
"Markov: SPM, ASF", "Markov: FPM, ASF", "Markov: FPM, RSF"),
name = "") +
guides(x = "axis_minor", y = "axis_minor",
color = guide_legend(nrow = 4, override.aes = list(linewidth = 1.2)), linetype = guide_legend(nrow = 4), keyheight = unit(2, "lines")) +
theme(legend.position = "bottom",
legend.title = element_text(size = 24),
legend.key = element_rect(colour = NA, fill = NA),
legend.key.width = unit(1.5, "cm"),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.line = element_line(color = "black"),
plot.title = element_text(hjust = 0.5, size = 24),
axis.text = element_text(size = 12),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
legend.text = element_text(size = 12)) +
ggtitle("RFC")
plot_RFC
plot_FC <- ggplot() +
# Semi-Markov: SPM, ASF (Williams2017)
geom_line(data = OS_semiMarkov_williams_ac_FC, aes(x = time, y = prob*100, color = "l3", linetype = "l3"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 1)  +
# Semi-Markov: FPM, ASF
geom_line(data = OS_semiMarkov_fpm_ac_FC, aes(x = time, y = prob*100, color = "l4", linetype = "l4"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 1)  +
# Semi-Markov: FPM, RSF
geom_line(data = OS_semiMarkov_fpm_rel_FC, aes(x = time, y = prob*100, color = "l5", linetype = "l5"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
# Markov: SPM, ASF
geom_line(data = OS_Markov_williams_ac_FC, aes(x = time, y = prob*100, color = "l6", linetype = "l6"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
# Markov: FPM, ASF
geom_line(data = OS_Markov_fpm_ac_FC, aes(x = time, y = prob*100, color = "l7", linetype = "l7"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
# Markov: FPM, RSF
geom_line(data = OS_Markov_fpm_rel_FC, aes(x = time, y = prob*100, color = "l8", linetype = "l8"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
# Observed 8 years  (Fischer2016)
geom_step(data = mfit2_data_FC, aes(x = time, y = surv*100, color = "l2", linetype = "l2"), inherit.aes = FALSE,
direction = "hv", linewidth = 1.2, alpha = 0.8)  +
# Observed 4 years (Hallek2010)
geom_step(data = mfit1_data_FC, aes(x = time, y = surv*100, color = "l1", linetype = "l1"), inherit.aes = FALSE,
direction = "hv", linewidth = 1.2, alpha = 0.8) +
labs(x = "Time (years)", y = "Survival probability (%)", fill = "") +
scale_x_continuous(breaks = seq(0, 50, by = 5), limits = c(0, 50),
labels = seq(0, 50, by = 5), minor_breaks = seq(0, 50, by = 1)) +
scale_y_continuous(breaks = seq(0, 100, by = 20), limits = c(0, 100),
labels = seq(0, 100, by = 20), minor_breaks = seq(0, 100, by = 5)) +
scale_color_manual(values = c("l1" = "black", "l2" = "darkolivegreen3",
"l3" = "royalblue2", "l4" = "mediumorchid3",
"l5" = "firebrick2", "l6" = "darkorange1",
"l7" = "gold", "l8" = "cyan"),
labels = c("Observed 4-year OS", "Observed 8-year OS", "Semi-Markov: SPM, ASF (Williams 2017)",
"Semi-Markov: FPM, ASF", "Microsimulation: SPM, ASF", "Microsimulation: FPM, ASF",
"Microsimulation: FPM, RSF"),
name = "") +
scale_linetype_manual(values = c("l1" = "solid", "l2" = "solid", "l3" = "dashed", "l4" = "twodash", "l5" = "dotdash", "l6" = "longdash", "l7" = "dashed", "l8" = "twodash"),
labels = c("Observed 4-year OS", "Observed 8-year OS", "Semi-Markov: SPM, ASF (Williams 2017)",
"Semi-Markov: FPM, ASF", "Semi-Markov: FPM, RSF",
"Markov: SPM, ASF", "Markov: FPM, ASF", "Markov: FPM, RSF"),
name = "") +
guides(x = "axis_minor", y = "axis_minor",
color = guide_legend(nrow = 4, override.aes = list(linewidth = 1.2)), linetype = guide_legend(nrow = 4), keyheight = unit(2, "lines")) +
theme(legend.position = "bottom",
legend.title = element_text(size = 24),
legend.key = element_rect(colour = NA, fill = NA),
legend.key.width = unit(1.5, "cm"),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.line = element_line(color = "black"),
plot.title = element_text(hjust = 0.5, size = 24),
axis.text = element_text(size = 12),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
legend.text = element_text(size = 12)) +
ggtitle("FC")
plot_FC
plot_FC <- ggplot() +
# Semi-Markov: SPM, ASF (Williams2017)
geom_line(data = OS_semiMarkov_williams_ac_FC, aes(x = time, y = prob*100, color = "l3", linetype = "l3"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 1)  +
# Semi-Markov: FPM, ASF
geom_line(data = OS_semiMarkov_fpm_ac_FC, aes(x = time, y = prob*100, color = "l4", linetype = "l4"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 1)  +
# Semi-Markov: FPM, RSF
geom_line(data = OS_semiMarkov_fpm_rel_FC, aes(x = time, y = prob*100, color = "l5", linetype = "l5"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
# Markov: SPM, ASF
geom_line(data = OS_Markov_williams_ac_FC, aes(x = time, y = prob*100, color = "l6", linetype = "l6"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
# Markov: FPM, ASF
geom_line(data = OS_Markov_fpm_ac_FC, aes(x = time, y = prob*100, color = "l7", linetype = "l7"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
# Markov: FPM, RSF
geom_line(data = OS_Markov_fpm_rel_FC, aes(x = time, y = prob*100, color = "l8", linetype = "l8"), inherit.aes = FALSE,
linewidth = 1.2, alpha = 0.8) +
# Observed 8 years  (Fischer2016)
geom_step(data = mfit2_data_FC, aes(x = time, y = surv*100, color = "l2", linetype = "l2"), inherit.aes = FALSE,
direction = "hv", linewidth = 1.2, alpha = 0.8)  +
# Observed 4 years (Hallek2010)
geom_step(data = mfit1_data_FC, aes(x = time, y = surv*100, color = "l1", linetype = "l1"), inherit.aes = FALSE,
direction = "hv", linewidth = 1.2, alpha = 0.8) +
labs(x = "Time (years)", y = "Survival probability (%)", fill = "") +
scale_x_continuous(breaks = seq(0, 50, by = 5), limits = c(0, 50),
labels = seq(0, 50, by = 5), minor_breaks = seq(0, 50, by = 1)) +
scale_y_continuous(breaks = seq(0, 100, by = 20), limits = c(0, 100),
labels = seq(0, 100, by = 20), minor_breaks = seq(0, 100, by = 5)) +
scale_color_manual(values = c("l1" = "black", "l2" = "darkolivegreen3",
"l3" = "royalblue2", "l4" = "mediumorchid3",
"l5" = "firebrick2", "l6" = "darkorange1",
"l7" = "gold", "l8" = "cyan"),
labels = c("Observed 4-year OS", "Observed 8-year OS",
"Semi-Markov: SPM, ASF (Williams 2017)", "Semi-Markov: FPM, ASF", "Semi-Markov: FPM, RSF",
"Markov: SPM, ASF", "Markov: FPM, ASF", "Markov: FPM, RSF"),
name = "") +
scale_linetype_manual(values = c("l1" = "solid", "l2" = "solid", "l3" = "dashed", "l4" = "twodash", "l5" = "dotdash", "l6" = "longdash", "l7" = "dashed", "l8" = "twodash"),
labels = c("Observed 4-year OS", "Observed 8-year OS", "Semi-Markov: SPM, ASF (Williams 2017)",
"Semi-Markov: FPM, ASF", "Semi-Markov: FPM, RSF",
"Markov: SPM, ASF", "Markov: FPM, ASF", "Markov: FPM, RSF"),
name = "") +
guides(x = "axis_minor", y = "axis_minor",
color = guide_legend(nrow = 4, override.aes = list(linewidth = 1.2)), linetype = guide_legend(nrow = 4), keyheight = unit(2, "lines")) +
theme(legend.position = "bottom",
legend.title = element_text(size = 24),
legend.key = element_rect(colour = NA, fill = NA),
legend.key.width = unit(1.5, "cm"),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.line = element_line(color = "black"),
plot.title = element_text(hjust = 0.5, size = 24),
axis.text = element_text(size = 12),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
legend.text = element_text(size = 12)) +
ggtitle("FC")
plot_FC
##############################################################
##============================================================
## Combine RFC and FC plots into one figure and export
##============================================================
##############################################################
## Plot two figures together
plot <- ggarrange(plot_RFC, plot_FC, ncol = 2,
common.legend = TRUE, legend="bottom",
align = "h")
plot
source("~/Library/CloudStorage/OneDrive-KarolinskaInstitutet/ec_phd/Study2_Microsim/ChenEYT_microsim/Program/05_fullmod_microsim_fpm_rel.R", echo=TRUE)
source("~/Library/CloudStorage/OneDrive-KarolinskaInstitutet/ec_phd/Study2_Microsim/ChenEYT_microsim/Program/06_fullmod_onewaysen.R", echo=TRUE)
source("~/Library/CloudStorage/OneDrive-KarolinskaInstitutet/ec_phd/Study2_Microsim/ChenEYT_microsim/Program/07_fullmod_PSA.R", echo=TRUE)
source("~/Library/CloudStorage/OneDrive-KarolinskaInstitutet/ec_phd/Study2_Microsim/ChenEYT_microsim/Program/07_fullmod_PSA.R", echo=TRUE)
source("~/Library/CloudStorage/OneDrive-KarolinskaInstitutet/ec_phd/Study2_Microsim/ChenEYT_microsim/Program/08_CEplane_CEAC.R", echo=TRUE)
setwd("~/Library/CloudStorage/OneDrive-KarolinskaInstitutet/ec_phd/Study2_Microsim/ChenEYT_microsim/Program")
source("~/Library/CloudStorage/OneDrive-KarolinskaInstitutet/ec_phd/Study2_Microsim/ChenEYT_microsim/Program/08_CEplane_CEAC.R", echo=TRUE)
source("~/Library/CloudStorage/OneDrive-KarolinskaInstitutet/ec_phd/Study2_Microsim/ChenEYT_microsim/Program/08_CEplane_CEAC.R", echo=TRUE)
source("~/Library/CloudStorage/OneDrive-KarolinskaInstitutet/ec_phd/Study2_Microsim/ChenEYT_microsim/Program/08_CEplane_CEAC.R", echo=TRUE)
source("~/Library/CloudStorage/OneDrive-KarolinskaInstitutet/ec_phd/Study2_Microsim/ChenEYT_microsim/Program/04c_figure_survextrap.R", echo=TRUE)
source("~/Library/CloudStorage/OneDrive-KarolinskaInstitutet/ec_phd/Study2_Microsim/ChenEYT_microsim/Program/08_CEplane_CEAC.R", echo=TRUE)
